f=@(x,u) [u(2);u(1)+2*u(4)-0.987722529*((u(1)+0.012277471)/((((u(1)+0.012277471)^2)+u(3)^2)^(3/2)))-0.012277471*((u(1)-0.987722529)/((((u(1)-0.987722529)^2)+u(3)^2)^(3/2))); u(4); u(3)-2*u(2)-0.987722529*(u(3)/((((u(1)+0.012277471)^2)+u(3)^2)^(3/2)))-0.012277471*(u(3)/((((u(1)-0.987722529)^2)+u(3)^2)^(3/2)))];
steps =[100,1000,10000,20000];
for i=1:4
    h=(17.1)/steps(i);
    x=linspace(0,17.1,steps(i));
    u=ones(4,steps(i));
    u(:,1)=[0.994,0,0,-2.0015851063790825224205378622]';
    for i=1:steps(i)
        K1=h.*f(x(i),u(:,i));
        K2=h.*f(x(i)+h/2,u(:,i)+K1./2);
        K3=h.*f(x(i)+h/2,u(:,i)+K2./2);
        K4=h.*f(x(i)+h,u(:,i)+K3);
        u(:,i+1) = u(:,i)+(K1+2.*K2+2.*K3+K4)/6;
    end
    figure(i);
    plot(u(1,:),u(3,:));
end